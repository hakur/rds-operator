kind: Mysql
apiVersion: rds.hakurei.cn/v1alpha1
metadata:
  name: yuxing
spec:
  rootPassword: "zerocube"
  clusterMode: MGRSP
  backupPolicy: BackupDataDir
  storageClassName: hostpath
  timeZone: Asia/Shanghai
  configImage: rumia/mysql-config:v0.0.1
  mysql:
    image: mysql/mysql-server:5.7.34
    masterReplicas: 1
    replicas: 3
    storageSize: 1Gi
    maxConn: 300
    whitelist:
      - "10.0.0.0/8"
    mgrsp:
      applierThreshold: 2500
      mgrRetries: 100
    extraConfigDir: /etc/my.cnf.d/
    users:
    - databaseTarget: "*.*"
      domain: "%"
      password: "monitor_me"
      privileges:
        - "REPLICATION SLAVE"
        - "REPLICATION CLIENT"
        - "SELECT"
      username: monitor
    - databaseTarget: "*.*"
      domain: "%"
      password: "replication"
      privileges:
        - "REPLICATION SLAVE"
        - "REPLICATION CLIENT"
        - "SELECT"
      username: mgr
    replicationUser: mgr
  proxysql: 
    image: proxysql/proxysql:2.2.0
    mysqlVersion: "5.7.34"
    monitorUser: "monitor"
    monitorPassword: "monitor_me"
    adminUser: admin
    adminPassword: zerocube
    nodePort: 32336
    storageSize: 1Gi